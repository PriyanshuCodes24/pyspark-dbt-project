snapshots:
  - name: DimCustomers
    relation: source('silver', 'customers')
    config:
      schema: gold
      database: pyspark_dbt
      unique_key: customer_id
      strategy: timestamp
      updated_at: last_updated_timestamp
      dbt_valid_to_current: "to_date('9999-12-31')" # Specifies that current records should have `dbt_valid_to` set to `'9999-12-31'` instead of `NULL`.


  - name: DimLocations
    relation: source('silver', 'locations')
    config:
      schema: gold
      database: pyspark_dbt
      unique_key: location_id
      strategy: timestamp
      updated_at: last_updated_timestamp
      dbt_valid_to_current: "to_date('9999-12-31')" 


  - name: DimDrivers
    relation: source('silver', 'drivers')
    config:
      schema: gold
      database: pyspark_dbt
      unique_key: driver_id
      strategy: timestamp
      updated_at: last_updated_timestamp
      dbt_valid_to_current: "to_date('9999-12-31')"   


  - name: DimPayments
    relation: source('silver', 'payments')
    config:
      schema: gold
      database: pyspark_dbt
      unique_key: payment_id
      strategy: timestamp
      updated_at: last_updated_timestamp
      dbt_valid_to_current: "to_date('9999-12-31')"  

  
  - name: DimVehicle
    relation: source('silver', 'vehicles')
    config:
      schema: gold
      database: pyspark_dbt
      unique_key: vehicle_id
      strategy: timestamp
      updated_at: last_updated_timestamp
      dbt_valid_to_current: "to_date('9999-12-31')" 